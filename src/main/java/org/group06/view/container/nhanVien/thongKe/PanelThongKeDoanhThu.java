/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package org.group06.view.container.nhanVien.thongKe;

import org.group06.db.DatabaseConnect;
import org.group06.db.dao.DAO_ChiTietHoaDon;
import org.group06.db.dao.DAO_HoaDon;
import org.group06.model.entity.ChiTietHoaDon;
import org.group06.model.entity.HoaDon;
import org.group06.utils.NumberStandard;

import java.sql.Connection;
import java.time.Instant;
import java.util.ArrayList;
import java.util.Date;
import java.util.Locale;

/**
 * @author Le Minh Bao
 */
public class PanelThongKeDoanhThu extends javax.swing.JPanel {

    private Connection connection = DatabaseConnect.getConnection();
    private DAO_ChiTietHoaDon dao_chiTietHoaDon = new DAO_ChiTietHoaDon(connection);
    private ArrayList<ChiTietHoaDon> dsChiTietHoaDon = dao_chiTietHoaDon.getAll();

    /**
     * Creates new form PanelThongKeDoanhThu
     */
    public PanelThongKeDoanhThu() {
        initComponents();
        uploadIncomeData();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        lblTitle = new javax.swing.JLabel();
        pnlGeneral = new javax.swing.JPanel();
        pnlDoanhSo = new javax.swing.JPanel();
        lblTongSoHoaDon = new javax.swing.JLabel();
        lblSoQuanAoDaBan = new javax.swing.JLabel();
        lblTongDoanhThu = new javax.swing.JLabel();
        lblLoiNhuanThuDuoc = new javax.swing.JLabel();
        txtTongSoHoaDon = new javax.swing.JTextField();
        txtSoQuanAoDaBan = new javax.swing.JTextField();
        txtTongDoanhThu = new javax.swing.JTextField();
        txtLoiNhuanThuDuoc = new javax.swing.JTextField();
        cmbLuaChonThongKe = new javax.swing.JComboBox<>();
        lblNgayThongKe = new javax.swing.JLabel();
        dchNgayThongKe = new com.toedter.calendar.JDateChooser();
        lblNgayThongKeCuoi = new javax.swing.JLabel();
        dchNgayThongKeCuoi = new com.toedter.calendar.JDateChooser();
        tabLuaChonXem = new javax.swing.JTabbedPane();
        pnlBangChiTiet = new javax.swing.JPanel();
        scrHdGiaTriCaoNhat = new javax.swing.JScrollPane();
        tblHdGiaTriCaoNhat = new javax.swing.JTable();
        scrHdLoiNhuanCaoNhat = new javax.swing.JScrollPane();
        tblHdLoiNhuanCaoNhat = new javax.swing.JTable();
        pnlBieuDoTrucQuan = new javax.swing.JPanel();

        lblTitle.setFont(new java.awt.Font("Segoe UI", 1, 36)); // NOI18N
        lblTitle.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblTitle.setText("Thống Kê Doanh Thu Cửa Hàng");
        lblTitle.setHorizontalTextPosition(javax.swing.SwingConstants.LEFT);

        pnlGeneral.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Tổng Quan", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 1, 14))); // NOI18N

        pnlDoanhSo.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Doanh Số", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 1, 14))); // NOI18N

        lblTongSoHoaDon.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        lblTongSoHoaDon.setText("Tổng hoá đơn đã lập:");

        lblSoQuanAoDaBan.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        lblSoQuanAoDaBan.setText("Số quần áo đã bán:");

        lblTongDoanhThu.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        lblTongDoanhThu.setText("Tổng doanh thu:");

        lblLoiNhuanThuDuoc.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        lblLoiNhuanThuDuoc.setText("Lợi nhuận thu được:");

        txtTongSoHoaDon.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        txtTongSoHoaDon.setHorizontalAlignment(javax.swing.JTextField.TRAILING);
        txtTongSoHoaDon.setDisabledTextColor(java.awt.Color.black);
        txtTongSoHoaDon.setEnabled(false);

        txtSoQuanAoDaBan.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        txtSoQuanAoDaBan.setHorizontalAlignment(javax.swing.JTextField.TRAILING);
        txtSoQuanAoDaBan.setDisabledTextColor(java.awt.Color.black);
        txtSoQuanAoDaBan.setEnabled(false);

        txtTongDoanhThu.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        txtTongDoanhThu.setHorizontalAlignment(javax.swing.JTextField.TRAILING);
        txtTongDoanhThu.setDisabledTextColor(java.awt.Color.black);
        txtTongDoanhThu.setEnabled(false);

        txtLoiNhuanThuDuoc.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        txtLoiNhuanThuDuoc.setHorizontalAlignment(javax.swing.JTextField.TRAILING);
        txtLoiNhuanThuDuoc.setDisabledTextColor(java.awt.Color.black);
        txtLoiNhuanThuDuoc.setEnabled(false);

        javax.swing.GroupLayout pnlDoanhSoLayout = new javax.swing.GroupLayout(pnlDoanhSo);
        pnlDoanhSo.setLayout(pnlDoanhSoLayout);
        pnlDoanhSoLayout.setHorizontalGroup(
            pnlDoanhSoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlDoanhSoLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnlDoanhSoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(pnlDoanhSoLayout.createSequentialGroup()
                        .addComponent(lblTongSoHoaDon)
                        .addGap(18, 18, 18)
                        .addComponent(txtTongSoHoaDon))
                    .addGroup(pnlDoanhSoLayout.createSequentialGroup()
                        .addComponent(lblLoiNhuanThuDuoc)
                        .addGap(18, 18, 18)
                        .addComponent(txtLoiNhuanThuDuoc, javax.swing.GroupLayout.DEFAULT_SIZE, 433, Short.MAX_VALUE))
                    .addGroup(pnlDoanhSoLayout.createSequentialGroup()
                        .addComponent(lblSoQuanAoDaBan)
                        .addGap(18, 18, 18)
                        .addComponent(txtSoQuanAoDaBan, javax.swing.GroupLayout.DEFAULT_SIZE, 433, Short.MAX_VALUE))
                    .addGroup(pnlDoanhSoLayout.createSequentialGroup()
                        .addComponent(lblTongDoanhThu)
                        .addGap(18, 18, 18)
                        .addComponent(txtTongDoanhThu, javax.swing.GroupLayout.DEFAULT_SIZE, 433, Short.MAX_VALUE)))
                .addContainerGap())
        );

        pnlDoanhSoLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {lblLoiNhuanThuDuoc, lblSoQuanAoDaBan, lblTongDoanhThu, lblTongSoHoaDon});

        pnlDoanhSoLayout.setVerticalGroup(
            pnlDoanhSoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlDoanhSoLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnlDoanhSoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblTongSoHoaDon)
                    .addComponent(txtTongSoHoaDon, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(0, 18, Short.MAX_VALUE)
                .addGroup(pnlDoanhSoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblSoQuanAoDaBan)
                    .addComponent(txtSoQuanAoDaBan, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(pnlDoanhSoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblTongDoanhThu)
                    .addComponent(txtTongDoanhThu, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(pnlDoanhSoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblLoiNhuanThuDuoc)
                    .addComponent(txtLoiNhuanThuDuoc, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );

        pnlDoanhSoLayout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {lblLoiNhuanThuDuoc, lblSoQuanAoDaBan, lblTongDoanhThu, lblTongSoHoaDon, txtTongSoHoaDon});

        cmbLuaChonThongKe.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        cmbLuaChonThongKe.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Thống kê theo ngày", "Thống kê theo tháng", "Thống kê theo năm", "Thống kê theo khoảng thời gian", "Thống kê tất cả thời gian" }));
        cmbLuaChonThongKe.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cmbLuaChonThongKeItemStateChanged(evt);
            }
        });

        lblNgayThongKe.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        lblNgayThongKe.setText("Chọn ngày thống kê:");

        dchNgayThongKe.setDate(new java.util.Date());
        dchNgayThongKe.setDateFormatString("dd-MM-yyyy");
        dchNgayThongKe.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        dchNgayThongKe.setMaxSelectableDate(Date.from(Instant.now())
        );
        dchNgayThongKe.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                dchNgayThongKeFocusGained(evt);
            }
        });
        dchNgayThongKe.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                dchNgayThongKePropertyChange(evt);
            }
        });

        lblNgayThongKeCuoi.setVisible(false);
        lblNgayThongKeCuoi.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        lblNgayThongKeCuoi.setText("Đến ngày:");

        dchNgayThongKeCuoi.setVisible(false);
        dchNgayThongKeCuoi.setDate(new java.util.Date());
        dchNgayThongKeCuoi.setDateFormatString("dd-MM-yyyy");
        dchNgayThongKeCuoi.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        dchNgayThongKeCuoi.setMinSelectableDate(dchNgayThongKe.getDate()
        );
        dchNgayThongKeCuoi.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                dchNgayThongKeCuoiFocusGained(evt);
            }
        });
        dchNgayThongKeCuoi.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                dchNgayThongKeCuoiPropertyChange(evt);
            }
        });

        javax.swing.GroupLayout pnlGeneralLayout = new javax.swing.GroupLayout(pnlGeneral);
        pnlGeneral.setLayout(pnlGeneralLayout);
        pnlGeneralLayout.setHorizontalGroup(
            pnlGeneralLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pnlGeneralLayout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(pnlGeneralLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(lblNgayThongKe)
                    .addComponent(lblNgayThongKeCuoi)
                    .addComponent(cmbLuaChonThongKe, 0, 350, Short.MAX_VALUE)
                    .addComponent(dchNgayThongKe, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(dchNgayThongKeCuoi, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(50, 50, 50)
                .addComponent(pnlDoanhSo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        pnlGeneralLayout.setVerticalGroup(
            pnlGeneralLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlGeneralLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(cmbLuaChonThongKe, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(lblNgayThongKe)
                .addGap(7, 7, 7)
                .addComponent(dchNgayThongKe, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lblNgayThongKeCuoi)
                .addGap(7, 7, 7)
                .addComponent(dchNgayThongKeCuoi, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(11, 11, 11))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pnlGeneralLayout.createSequentialGroup()
                .addComponent(pnlDoanhSo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        dchNgayThongKe.setLocale(new Locale("vi", "VN"));
        dchNgayThongKe.getCalendarButton().setIcon(org.group06.utils.ImagePath.loadBlackIcon(org.group06.utils.ImagePath.ICON_CALENDAR));
        dchNgayThongKe.getDateEditor().setEnabled(false);
        ((com.toedter.calendar.JTextFieldDateEditor) dchNgayThongKe.getDateEditor()).setDisabledTextColor(java.awt.Color.BLACK);
        dchNgayThongKeCuoi.setLocale(new Locale("vi", "VN"));
        dchNgayThongKeCuoi.getCalendarButton().setIcon(org.group06.utils.ImagePath.loadBlackIcon(org.group06.utils.ImagePath.ICON_CALENDAR));
        dchNgayThongKeCuoi.getDateEditor().setEnabled(false);
        ((com.toedter.calendar.JTextFieldDateEditor) dchNgayThongKeCuoi.getDateEditor()).setDisabledTextColor(java.awt.Color.BLACK);

        tabLuaChonXem.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N

        scrHdGiaTriCaoNhat.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Top Hoá Đơn Giá Trị Cao Nhất", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 1, 14))); // NOI18N

        tblHdGiaTriCaoNhat.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        tblHdGiaTriCaoNhat.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Mã Hoá Đơn", "Ngày Tạo", "Khách Hàng", "Doanh Thu"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblHdGiaTriCaoNhat.setFillsViewportHeight(true);
        tblHdGiaTriCaoNhat.setRowHeight(50);
        tblHdGiaTriCaoNhat.setShowGrid(true);
        tblHdGiaTriCaoNhat.getTableHeader().setResizingAllowed(false);
        tblHdGiaTriCaoNhat.getTableHeader().setReorderingAllowed(false);
        scrHdGiaTriCaoNhat.setViewportView(tblHdGiaTriCaoNhat);

        scrHdLoiNhuanCaoNhat.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Top Hoá Đơn Lợi Nhuận Cao Nhất", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 1, 14))); // NOI18N

        tblHdLoiNhuanCaoNhat.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        tblHdLoiNhuanCaoNhat.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Mã Hoá Đơn", "Ngày Tạo", "Khách Hàng", "Lợi Nhuận"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblHdLoiNhuanCaoNhat.setFillsViewportHeight(true);
        tblHdLoiNhuanCaoNhat.setRowHeight(50);
        tblHdLoiNhuanCaoNhat.setShowGrid(true);
        tblHdLoiNhuanCaoNhat.getTableHeader().setResizingAllowed(false);
        tblHdLoiNhuanCaoNhat.getTableHeader().setReorderingAllowed(false);
        scrHdLoiNhuanCaoNhat.setViewportView(tblHdLoiNhuanCaoNhat);

        javax.swing.GroupLayout pnlBangChiTietLayout = new javax.swing.GroupLayout(pnlBangChiTiet);
        pnlBangChiTiet.setLayout(pnlBangChiTietLayout);
        pnlBangChiTietLayout.setHorizontalGroup(
            pnlBangChiTietLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pnlBangChiTietLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(scrHdGiaTriCaoNhat, javax.swing.GroupLayout.DEFAULT_SIZE, 502, Short.MAX_VALUE)
                .addGap(50, 50, 50)
                .addComponent(scrHdLoiNhuanCaoNhat, javax.swing.GroupLayout.DEFAULT_SIZE, 502, Short.MAX_VALUE)
                .addContainerGap())
        );
        pnlBangChiTietLayout.setVerticalGroup(
            pnlBangChiTietLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
            .addGroup(pnlBangChiTietLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnlBangChiTietLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(scrHdLoiNhuanCaoNhat, javax.swing.GroupLayout.DEFAULT_SIZE, 541, Short.MAX_VALUE)
                    .addComponent(scrHdGiaTriCaoNhat, javax.swing.GroupLayout.DEFAULT_SIZE, 541, Short.MAX_VALUE))
                .addContainerGap())
        );

        tabLuaChonXem.addTab("Bảng Chi Tiết", pnlBangChiTiet);

        javax.swing.GroupLayout pnlBieuDoTrucQuanLayout = new javax.swing.GroupLayout(pnlBieuDoTrucQuan);
        pnlBieuDoTrucQuan.setLayout(pnlBieuDoTrucQuanLayout);
        pnlBieuDoTrucQuanLayout.setHorizontalGroup(
            pnlBieuDoTrucQuanLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 1066, Short.MAX_VALUE)
        );
        pnlBieuDoTrucQuanLayout.setVerticalGroup(
            pnlBieuDoTrucQuanLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 553, Short.MAX_VALUE)
        );

        tabLuaChonXem.addTab("Biểu Đồ Trực Quan", pnlBieuDoTrucQuan);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(tabLuaChonXem)
                    .addComponent(lblTitle, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(pnlGeneral, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(lblTitle)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(pnlGeneral, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(tabLuaChonXem)
                .addGap(0, 0, 0))
        );
    }// </editor-fold>//GEN-END:initComponents

    private void cmbLuaChonThongKeItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cmbLuaChonThongKeItemStateChanged
        int selected = cmbLuaChonThongKe.getSelectedIndex();

        switch (selected) {
            case 0:
                toogleDateRangeSelect(false);
                break;
            case 1:
                toogleDateRangeSelect(false);
                lblNgayThongKe.setText("Chọn tháng thống kê");
                break;
            case 2:
                toogleDateRangeSelect(false);
                lblNgayThongKe.setText("Chọn năm thống kê");
                break;
            case 3:
                toogleDateRangeSelect(true);
                break;
            case 4:
                toogleDateRangeSelect(false, true);
                break;
        }
    }//GEN-LAST:event_cmbLuaChonThongKeItemStateChanged

    private void dchNgayThongKePropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_dchNgayThongKePropertyChange
        synchrorizeDateRange();
    }//GEN-LAST:event_dchNgayThongKePropertyChange

    private void dchNgayThongKeCuoiPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_dchNgayThongKeCuoiPropertyChange
        synchrorizeDateRange();
    }//GEN-LAST:event_dchNgayThongKeCuoiPropertyChange

    private void dchNgayThongKeFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_dchNgayThongKeFocusGained
        synchrorizeDateRange();
    }//GEN-LAST:event_dchNgayThongKeFocusGained

    private void dchNgayThongKeCuoiFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_dchNgayThongKeCuoiFocusGained
        synchrorizeDateRange();
    }//GEN-LAST:event_dchNgayThongKeCuoiFocusGained

    /**
     * DĐặt các thành phần hiển thị ngày thống kê, ngày thống kê cuối ẩn hoặc hiện
     *
     * @param state   Trạng thái hiển thị của ngày thống kê cuối, nếu false thì ẩn ngày thống kê cuối
     * @param allTime Nếu true thì ẩn ngày thống kê và cả ngày thống kê cuối, bỏ qua tham số state
     */
    private void toogleDateRangeSelect(boolean state, boolean allTime) {
        lblNgayThongKe.setVisible(!allTime);
        dchNgayThongKe.setVisible(!allTime);
        lblNgayThongKeCuoi.setVisible(state);
        dchNgayThongKeCuoi.setVisible(state);

        if (allTime) {
            return;
        }

        if (state) {
            lblNgayThongKe.setText("Từ ngày:");
            dchNgayThongKe.setDate(new java.util.Date());
            dchNgayThongKe.setMaxSelectableDate(dchNgayThongKeCuoi.getDate());
        } else {
            lblNgayThongKe.setText("Chọn ngày thống kê:");
            dchNgayThongKe.setDate(new java.util.Date());
            dchNgayThongKe.setMaxSelectableDate(Date.from(Instant.now()));
        }
    }

    private void synchrorizeDateRange() {
        if (dchNgayThongKeCuoi.isVisible()) {
            dchNgayThongKe.setMaxSelectableDate(dchNgayThongKeCuoi.getDate());
            dchNgayThongKeCuoi.setMinSelectableDate(dchNgayThongKe.getDate());
        }
    }

    private void uploadIncomeData() {
        int tongSoHoaDon = 0;
        int tongSoQuanAo = 0;
        double tongDoanhThu = 0.0f;
        double loiNhuanThuDuoc = 0.0f;

        tongSoHoaDon = new DAO_HoaDon(connection).getAll().size();

        for (ChiTietHoaDon chiTietHoaDon : dsChiTietHoaDon) {
            tongSoQuanAo += chiTietHoaDon.getSoLuong();
            tongDoanhThu += chiTietHoaDon.getSoLuong() * chiTietHoaDon.getGiaBan();
            loiNhuanThuDuoc += chiTietHoaDon.getSoLuong() * (chiTietHoaDon.getGiaBan() - chiTietHoaDon.getQuanAo().getGiaNhap());
        }

        txtTongSoHoaDon.setText(NumberStandard.formatInteger(tongSoHoaDon));
        txtSoQuanAoDaBan.setText(NumberStandard.formatInteger(tongSoQuanAo));
        txtTongDoanhThu.setText(NumberStandard.formatMoney(tongDoanhThu));
        txtLoiNhuanThuDuoc.setText(NumberStandard.formatMoney(loiNhuanThuDuoc));
    }

    private void uploadIncomeData(Date from) {
        int tongSoHoaDon = 0;
        int tongSoQuanAo = 0;
        double tongDoanhThu = 0.0f;
        double loiNhuanThuDuoc = 0.0f;

        ArrayList<HoaDon> dsHoaDon = new ArrayList<>();

        for (ChiTietHoaDon chiTietHoaDon : dsChiTietHoaDon) {
            if (chiTietHoaDon.getHoaDon().getNgayTao().compareTo(from) >= 0) {
                if (!dsHoaDon.contains(chiTietHoaDon.getHoaDon())) {
                    dsHoaDon.add(chiTietHoaDon.getHoaDon());
                    tongSoHoaDon++;
                }
                tongSoQuanAo += chiTietHoaDon.getSoLuong();
                tongDoanhThu += chiTietHoaDon.getSoLuong() * chiTietHoaDon.getGiaBan();
                loiNhuanThuDuoc += chiTietHoaDon.getSoLuong() * (chiTietHoaDon.getGiaBan() - chiTietHoaDon.getQuanAo().getGiaNhap());
            }
        }

        txtTongSoHoaDon.setText(NumberStandard.formatInteger(tongSoHoaDon));
        txtSoQuanAoDaBan.setText(NumberStandard.formatInteger(tongSoQuanAo));
        txtTongDoanhThu.setText(NumberStandard.formatMoney(tongDoanhThu));
        txtLoiNhuanThuDuoc.setText(NumberStandard.formatMoney(loiNhuanThuDuoc));
    }

    private void toogleDateRangeSelect(boolean state) {
        toogleDateRangeSelect(state, false);
    }

    // <editor-fold defaultstate="collapsed" desc="Generated Code">
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JComboBox<String> cmbLuaChonThongKe;
    private com.toedter.calendar.JDateChooser dchNgayThongKe;
    private com.toedter.calendar.JDateChooser dchNgayThongKeCuoi;
    private javax.swing.JLabel lblLoiNhuanThuDuoc;
    private javax.swing.JLabel lblNgayThongKe;
    private javax.swing.JLabel lblNgayThongKeCuoi;
    private javax.swing.JLabel lblSoQuanAoDaBan;
    private javax.swing.JLabel lblTitle;
    private javax.swing.JLabel lblTongDoanhThu;
    private javax.swing.JLabel lblTongSoHoaDon;
    private javax.swing.JPanel pnlBangChiTiet;
    private javax.swing.JPanel pnlBieuDoTrucQuan;
    private javax.swing.JPanel pnlDoanhSo;
    private javax.swing.JPanel pnlGeneral;
    private javax.swing.JScrollPane scrHdGiaTriCaoNhat;
    private javax.swing.JScrollPane scrHdLoiNhuanCaoNhat;
    private javax.swing.JTabbedPane tabLuaChonXem;
    private javax.swing.JTable tblHdGiaTriCaoNhat;
    private javax.swing.JTable tblHdLoiNhuanCaoNhat;
    private javax.swing.JTextField txtLoiNhuanThuDuoc;
    private javax.swing.JTextField txtSoQuanAoDaBan;
    private javax.swing.JTextField txtTongDoanhThu;
    private javax.swing.JTextField txtTongSoHoaDon;
    // End of variables declaration//GEN-END:variables
    // </editor-fold>     
}
